<template>
  <span class="cu-avatar" :class="shape" :style="avatarStyle">
    <img :src="src" v-if="src" :style="{ 'object-fit': fit }" />
    <template v-else-if="$slots.default">
      <slot></slot>
    </template>
    <i class="cu-icon-avatar-filled avatar-icon" v-else></i>
  </span>
</template>

<script setup lang="ts">
import { computed } from 'vue';
import '../style/avatar.css';
import { randomColor } from '../../../tools';
import { avatarProps } from './main.props';
defineOptions({
  name: 'CuAvatar'
});

const props = defineProps(avatarProps);

const avatarStyle = computed(() => {
  return {
    width: props.size + 'px',
    height: props.size + 'px',
    fontSize: props.size / 3 + 'px',
    backgroundColor: backgroundColor.value
  };
});

const backgroundColor = computed(() => {
  if (!props.color) return undefined;
  if (props.color === 'random') return randomColor();
  return props.color;
});
</script>
