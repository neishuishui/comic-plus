<template>
  <teleport to="body">
    <transition name="cu-fade" @after-enter="emit('open')" @after-leave="emit('close')">
      <div class="cu-mode" :class="customClass" v-if="show" @click.self="emit('mode-click')" :style="modeStyle">
        <slot></slot>
      </div>
    </transition>
  </teleport>
</template>

<script setup lang="ts">
import { computed } from 'vue';
import '../style/mode.css';
import { getMaxZIndex, useLookScroll } from '../../../utils';

defineOptions({
  name: 'CuMode'
});

const props = defineProps({
  show: Boolean,
  customClass: String,
  lockScroll: Boolean
});
const emit = defineEmits(['open', 'close', 'mode-click']);

const isLockScroll = computed(() => props.show);

if (props.lockScroll) {
  useLookScroll(isLockScroll);
}

const modeStyle = computed(() => {
  return {
    zIndex: getMaxZIndex()
  };
});
</script>
