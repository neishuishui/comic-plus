<template>
  <label class="cu-switch" :style="style" :class="{ 'is-disabled': disabled }">
    <input type="checkbox" :checked="isCheck" :disabled="disabled" @change="change" v-show="false" />
    <span class="cu-switch__unactivetext" v-if="unActiveText">{{ unActiveText }}</span>
    <span class="cu-switch__inner">
      <span :class="isCheck ? 'is-active' : 'un-active'"></span>
    </span>
    <span class="cu-switch__activetext" v-if="activeText">{{ activeText }}</span>
  </label>
</template>

<script setup lang="ts">
import { computed } from 'vue';
import '../style/css';
import useItemValidate from '../../utils/mixin/validate.js';
defineOptions({
  name: 'CuSwitch'
});
const props = defineProps({
  modelValue: {
    type: [Boolean, String, Number],
    required: true
  },
  activeText: String,
  unActiveText: String,
  activeValue: [String, Number],
  unActiveValue: [String, Number],
  activeColor: String,
  unActiveColor: String,
  disabled: Boolean
});

const emit = defineEmits(['update:modelValue', 'change']);

const { itemValidate } = useItemValidate();

const isCheck = computed(() => {
  return typeof props.modelValue === 'boolean' ? props.modelValue : props.modelValue === props.activeValue;
});

const style = computed(() => {
  return {
    '--activeColor': props.activeColor || undefined,
    '--unActiveColor': props.unActiveColor || undefined
  };
});

function change(e: Event) {
  let val =
    typeof props.modelValue === 'boolean'
      ? e.target.checked
      : e.target.checked
      ? props.activeValue
      : props.unActiveValue;
  emit('update:modelValue', val);
  emit('change', val);
  itemValidate('change');
}
</script>
