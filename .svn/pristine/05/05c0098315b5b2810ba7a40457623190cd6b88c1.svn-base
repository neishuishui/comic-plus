<template>
  <div class="cu-option" @click="handleClick" :class="[{ active: isActive }, { disabled }]">
    <slot>{{ label }}</slot>
  </div>
</template>

<script setup lang="ts">
import { inject, computed } from 'vue';
import { optionProps } from './option.props';
import type { SelectProvide } from './type';
defineOptions({
  name: 'CuOption'
});
const props = defineProps(optionProps);

const parent = inject<SelectProvide>('select:parent');
parent && parent.optionSet(props);

const isActive = computed(() => {
  if (parent?.props.multiple) {
    return parent.props.modelValue.includes(props.value);
  } else {
    return parent?.props.modelValue === props.value;
  }
});

function handleClick() {
  parent && parent.optionClick(props.value);
}
</script>
