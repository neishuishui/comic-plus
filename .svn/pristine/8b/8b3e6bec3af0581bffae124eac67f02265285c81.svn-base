import { defineComponent, h, provide, computed } from "vue";
import type { CSSProperties } from 'vue'
import '../style/css';
import { menuProps, menuEmits } from './main.props';

export const Menu = defineComponent({
  name: 'CuMenu',
  setup(props, { slots, emit }) {

    function useItemClick(name: string | number) {
      emit('menu-click', name);
      emit('update:modelValue', name);
    }

    const style = computed<CSSProperties>(() => {
      return {
        '--active-background-color': props.activeBackgroundColor,
        '--active-text-color': props.activeTextColor,
        backgroundColor: props.backgroundColor,
        color: props.textColor,
      };
    });

    provide('menu:parent', {
      props,
      useItemClick,
      style
    });

    return () => h('ul', { class: ['cu-menu', props.mode], style: style.value }, slots)
  },
  props: menuProps,
  emit: menuEmits,
})