<template>
  <span class="cu-checkbox-group">
    <slot></slot>
  </span>
</template>

<script setup lang="ts">
import { provide, ref } from 'vue';
import '../style/css';
import useItemValidate from '../../utils/mixin/validate.js';
defineOptions({
  name: 'CuCheckboxGroup'
});

const props = defineProps<{
  modelValue: string[] | number[];
}>();
const emit = defineEmits(['update:modelValue', 'change']);

const { itemValidate } = useItemValidate();

const activeValue = ref(props.modelValue);

function changeItemCheck(val: boolean, label: string | number) {
  if (val) {
    activeValue.value.push(label);
  } else {
    activeValue.value.splice(
      activeValue.value.findIndex((v) => v === label),
      1
    );
  }
  emit('update:modelValue', activeValue.value);
  emit('change', activeValue.value);
  itemValidate('change');
}

provide('group:isGroup', true);
provide('group:activeValue', activeValue);
provide('group:changeItemCheck', changeItemCheck);
</script>
