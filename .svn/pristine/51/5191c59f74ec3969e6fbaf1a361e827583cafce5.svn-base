<template>
  <div class="cu-tabs" :class="type" :style="{ '--color': color }">
    <i class="left cu-icon-left" @click="scrollTo(-1)" v-if="haveScroll"></i>
    <i class="right cu-icon-right" @click="scrollTo(1)" v-if="haveScroll"></i>
    <div class="cu-tabs__list" ref="tabList">
      <slot></slot>
    </div>
  </div>
</template>

<script setup lang="ts">
import { provide, computed, ref } from 'vue';
import '../style/css';
defineOptions({
  name: 'CuTabs'
});
const props = defineProps({
  modelValue: [String, Number],
  type: {
    type: String,
    default: 'line'
  },
  color: String
});

const tabList = ref();

const activeValue = computed(() => {
  return props.modelValue;
});

const haveScroll = computed(() => {
  if (!tabList.value) return;
  return tabList.value.clientWidth < tabList.value.scrollWidth;
});

const emit = defineEmits(['update:modelValue', 'change']);

function useItemClick(name: string | number) {
  emit('update:modelValue', name);
  emit('change', name);
}

function scrollTo(flag: number) {
  tabList.value.scrollTo({
    left: tabList.value.scrollLeft + 200 * flag,
    behavior: 'smooth'
  });
}
provide('tabs:active', activeValue);
provide('tabs:type', props.type);
provide('tabs:useItemClick', useItemClick);
</script>
